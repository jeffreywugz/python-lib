<html>
  <head>
    <title>Fish</title>
    <link rel="stylesheet" type="text/css" href="fsh.css"/>
    <script type="application/javascript;version=1.8" src="core.js"></script>
    <script type="application/javascript;version=1.8" src="fsh.js"></script>
    <script type="application/javascript;version=1.8">
    var jsTag = '#js:';
    var jobSeqFilter = function(cmd){
        var m = cmd.match(jsvTag);
        if(!m)return [cmd];
        var seq = [parseInt(i)*1000 || i for each(i in (m[1] || _jsv_ || '').split(','))];
        return cmd.seqSub(jsvTag, seq);
    }
    var trivialFilter = function(line, content) [line];

    var content = ''
    function safe_set(_content){
        try{
            if(content != _content){content=_content; set(content);}
        }catch(e){
            alert('failed set content!');
        }
    }
        
    function filter(line, content, caret){
        safe_set(content);
        return trivialFilter(line, content) || [];
    }
        
    function initApp(){
        var fsh = fish(popen, $('fish'), filter, 'fish');
        fsh('', get());
    }
    </script>
  </head>
  <body onload="initApp()">
    <div id="fish" class="dev">${fish}</div>
  </body>
</html>
